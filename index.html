<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>æç®€æ”¶é“¶ Pro (ç»ˆæä¼˜åŒ–ç‰ˆ)</title>
    
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="https://unpkg.com/phosphor-icons"></script>
    <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        /* --- å…¨å±€åŸºç¡€ --- */
        body { 
            margin: 0; background-color: #f8fafc; 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            color: #1e293b; -webkit-tap-highlight-color: transparent;
        }
        [v-cloak] { display: none; }

        /* æ‘„åƒå¤´å®¹å™¨ */
        .scan-base { background-color: #000; border-radius: 12px; overflow: hidden; position: relative; }
        #reader video, #manage-reader video, #cashier-reader video { width: 100% !important; height: 100% !important; object-fit: cover !important; border-radius: 12px; }

        /* æ»šåŠ¨æ¡ä¼˜åŒ– */
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .custom-scroll::-webkit-scrollbar { width: 4px; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }

        /* äº¤äº’åé¦ˆ */
        .btn-press:active { transform: scale(0.97); opacity: 0.9; }
        
        /* åº•éƒ¨å¯¼èˆªæ¯›ç»ç’ƒ */
        .nav-blur { 
            background: rgba(255, 255, 255, 0.95); 
            backdrop-filter: blur(10px); 
            border-top: 1px solid rgba(0,0,0,0.05); 
            padding-bottom: env(safe-area-inset-bottom); 
        }

        /* åŠ¨ç”» */
        .transition-height { transition: height 0.3s ease, opacity 0.3s ease; }
        @keyframes fade-in-up { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in-up { animation: fade-in-up 0.3s ease-out forwards; }

        /* ç´§å‡‘åˆ—è¡¨æ ·å¼ä¼˜åŒ– */
        .compact-list-item { padding: 0.6rem 0.75rem; }
    </style>
</head>
<body>

<div id="app" v-cloak class="h-screen w-full flex flex-col md:flex-row bg-slate-50 overflow-hidden text-slate-800">

    <aside class="hidden md:flex w-64 bg-slate-900 text-white flex-col shrink-0">
        <div class="p-6 border-b border-slate-800">
            <h1 class="text-xl font-bold flex items-center gap-2"><i class="ph-storefront text-blue-500"></i> æ”¶é“¶ç³»ç»Ÿ Pro</h1>
            <div class="flex items-center gap-2 mt-3 text-xs text-slate-400 font-mono">
                <div :class="isOnline ? 'bg-green-500' : 'bg-red-500'" class="w-2 h-2 rounded-full"></div>
                <span>{{ isOnline ? 'äº‘ç«¯å·²è¿æ¥' : 'ç¦»çº¿æ¨¡å¼' }}</span>
            </div>
        </div>
        <nav class="flex-1 p-4 space-y-2">
            <a @click="switchTab('cashier')" :class="currentTab==='cashier'?'bg-blue-600 shadow-lg text-white':'text-slate-400 hover:bg-slate-800'" class="flex items-center gap-3 p-3 rounded-xl cursor-pointer transition-all font-medium"><i class="ph-barcode text-xl"></i> æ”¶é“¶å°</a>
            <a @click="switchTab('entry')" :class="currentTab==='entry'?'bg-blue-600 shadow-lg text-white':'text-slate-400 hover:bg-slate-800'" class="flex items-center gap-3 p-3 rounded-xl cursor-pointer transition-all font-medium"><i class="ph-plus-circle text-xl"></i> å•†å“å½•å…¥</a>
            <a @click="switchTab('manage')" :class="currentTab==='manage'?'bg-blue-600 shadow-lg text-white':'text-slate-400 hover:bg-slate-800'" class="flex items-center gap-3 p-3 rounded-xl cursor-pointer transition-all font-medium"><i class="ph-package text-xl"></i> å•†å“ç®¡ç†</a>
            <a @click="switchTab('orders')" :class="currentTab==='orders'?'bg-blue-600 shadow-lg text-white':'text-slate-400 hover:bg-slate-800'" class="flex items-center gap-3 p-3 rounded-xl cursor-pointer transition-all font-medium"><i class="ph-chart-bar text-xl"></i> é”€å”®æŠ¥è¡¨</a>
        </nav>
    </aside>

    <main class="flex-1 flex flex-col h-full relative overflow-hidden">
        
        <header class="md:hidden h-12 bg-white px-4 border-b border-slate-100 shrink-0 flex justify-between items-center z-20">
            <h1 class="font-bold text-base text-slate-800">{{ currentTitle }}</h1>
            <div class="flex items-center gap-2">
                <div :class="isOnline ? 'bg-green-500' : 'bg-red-500'" class="w-1.5 h-1.5 rounded-full"></div>
                <span class="text-[10px] text-slate-400 font-bold tracking-wider">{{ isOnline ? 'ONLINE' : 'OFFLINE' }}</span>
            </div>
        </header>

        <div ref="mainContent" class="flex-1 overflow-y-auto hide-scrollbar p-2 md:p-6 bg-slate-50 pb-24 md:pb-6">
            <div v-if="currentTab === 'cashier'" class="h-full flex flex-col md:flex-row gap-3 md:gap-4">
                
                <div v-if="scanning" class="w-full md:w-[350px] shrink-0 transition-all animate-fade-in-up">
                    <div class="scan-base h-[220px] md:h-full shadow-lg border border-slate-200 relative bg-black ring-4 ring-black/5">
                        <div id="cashier-reader" class="w-full h-full"></div>
                        <div class="absolute inset-0 border-2 border-white/20 rounded-xl pointer-events-none"></div>
                        <button @click="stopScanner" class="absolute bottom-3 left-1/2 -translate-x-1/2 bg-black/50 backdrop-blur text-white px-4 py-1.5 rounded-full text-xs font-bold border border-white/20 flex items-center gap-1 active:scale-95 transition-transform">
                            <i class="ph-x-circle text-base"></i> å…³é—­
                        </button>
                    </div>
                </div>

                <div class="flex-1 flex flex-col h-full overflow-hidden gap-2 md:gap-3 min-h-0">
                    
                    <div class="grid grid-cols-2 gap-2 bg-white p-1 rounded-xl shadow-sm border border-slate-100 shrink-0">
                        <button @click="switchPriceMode('retail')" :class="priceMode === 'retail' ? 'bg-blue-600 text-white shadow-md' : 'text-slate-500 hover:bg-slate-50'" class="py-2.5 rounded-lg font-bold text-xs md:text-sm transition-all flex items-center justify-center gap-1.5">
                            <i class="ph-tag-simple"></i> é›¶å”®
                        </button>
                        <button @click="switchPriceMode('wholesale')" :class="priceMode === 'wholesale' ? 'bg-orange-500 text-white shadow-md' : 'text-slate-500 hover:bg-slate-50'" class="py-2.5 rounded-lg font-bold text-xs md:text-sm transition-all flex items-center justify-center gap-1.5">
                            <i class="ph-package"></i> æ‰¹å‘
                        </button>
                    </div>

                    <div class="bg-white p-2 md:p-3 rounded-xl shadow-sm border border-slate-100 shrink-0">
                        <div class="relative">
                            <input ref="cashierInput" v-model="cashierSearch" @keyup.enter="addToCartByInput" @focus="scrollToInput($event)" type="text" placeholder="ç‚¹å‡»å½•å…¥ / æ‰«ç æªè¾“å…¥" class="w-full py-3 pl-10 pr-10 bg-slate-50 rounded-lg font-bold text-base border border-transparent focus:bg-white focus:border-blue-500 focus:ring-2 focus:ring-blue-500/10 transition-all placeholder:text-slate-300">
                            <i class="ph-barcode absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-lg"></i>
                            <button v-if="isMobile" @click="toggleScanner('cashier')" :class="scanning ? 'text-blue-600 bg-blue-50' : 'text-slate-500 bg-slate-100'" class="absolute right-1.5 top-1.5 p-2 rounded-md transition-all active:scale-95">
                                <i class="ph-qr-code text-lg"></i>
                            </button>
                        </div>
                    </div>

                    <div class="flex-1 flex flex-col bg-white rounded-xl shadow-sm border border-slate-100 overflow-hidden min-h-0 relative">
                        <div class="px-3 py-2 border-b border-slate-100 bg-slate-50/50 flex justify-between items-center shrink-0">
                            <div class="flex items-center gap-2">
                                <div class="w-1 h-3 rounded-full" :class="priceMode==='retail'?'bg-blue-500':'bg-orange-500'"></div>
                                <h3 class="font-bold text-slate-700 text-xs">æ¸…å• <span class="bg-slate-200 text-slate-600 px-1.5 rounded text-[10px] ml-0.5">{{ cartTotalQty }}</span></h3>
                            </div>
                            <button @click="clearCart" class="text-red-500 text-[10px] font-bold hover:bg-red-50 px-2 py-1 rounded transition-colors" v-if="cart.length > 0">æ¸…ç©º</button>
                        </div>
                        
                        <div class="flex-1 overflow-y-auto p-2 space-y-1.5 custom-scroll" id="cartContainer">
                            <div v-if="cart.length === 0" class="h-full flex flex-col items-center justify-center text-slate-300 select-none pb-10">
                                <i class="ph-shopping-cart text-3xl mb-2 text-slate-200"></i>
                                <p class="text-xs font-medium">æš‚æ— å•†å“</p>
                            </div>
                            <div v-for="(item, index) in cart" :key="index" class="flex flex-col p-2 bg-white border border-slate-100 rounded-lg shadow-sm active:border-blue-300 transition-all">
                                <div class="flex justify-between items-start mb-1">
                                    <div class="overflow-hidden">
                                        <div class="font-bold text-slate-800 text-sm truncate">{{ item.name }}</div>
                                        <div class="text-[10px] text-slate-400 font-mono">{{ item.barcode }}</div>
                                    </div>
                                    <button @click="removeFromCart(index)" class="text-slate-300 hover:text-red-500 p-1 -mr-1 -mt-1 active:scale-90"><i class="ph-trash text-base"></i></button>
                                </div>
                                <div class="flex justify-between items-center bg-slate-50 p-1.5 rounded border border-slate-50">
                                    <div class="flex items-center gap-1">
                                        <button @click="item.quantity > 1 ? item.quantity-- : removeFromCart(index)" class="w-7 h-7 bg-white rounded border border-slate-200 text-slate-700 font-bold active:scale-95 shadow-sm">-</button>
                                        <span class="w-6 text-center font-bold text-sm text-slate-800">{{ item.quantity }}</span>
                                        <button @click="item.quantity++" class="w-7 h-7 bg-blue-600 rounded text-white font-bold shadow-sm shadow-blue-100 active:scale-95">+</button>
                                    </div>
                                    <div class="text-right">
                                        <div class="relative">
                                            <span class="absolute left-0 top-1/2 -translate-y-1/2 text-[10px] font-bold text-slate-400">R$</span>
                                            <input v-model="item.unit_price" @focus="scrollToInput($event)" type="number" class="w-16 text-right font-bold text-base bg-transparent border-b border-transparent focus:border-blue-500 focus:bg-white rounded px-0.5 transition-all outline-none p-0 text-slate-800">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="px-3 py-3 border-t border-slate-100 bg-white shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.02)] flex items-center justify-between shrink-0 z-10 gap-3">
                            <div class="flex flex-col">
                                <span class="text-slate-400 text-[10px] font-bold uppercase">åˆè®¡</span>
                                <div class="text-2xl font-black text-slate-900 leading-none">R$ {{ cartTotalPrice }}</div>
                            </div>
                            <button @click="checkoutDirectly" :disabled="cart.length===0" class="flex-1 py-3 bg-slate-900 hover:bg-slate-800 text-white rounded-lg font-bold text-base shadow-lg shadow-slate-200 disabled:opacity-50 disabled:shadow-none btn-press transition-all flex items-center justify-center gap-2">
                                ç¡®è®¤æ”¶æ¬¾
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <div v-if="currentTab === 'manage'" class="space-y-3 md:space-y-4 max-w-7xl mx-auto h-full flex flex-col">
                
                <div class="flex flex-col md:flex-row gap-2 shrink-0">
                    <div class="flex gap-2 bg-white p-2 rounded-xl shadow-sm border border-slate-100 items-center flex-1">
                        <div class="relative flex-1">
                            <i class="ph-magnifying-glass absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-lg"></i>
                            <input ref="manageInput" v-model="searchText" @focus="scrollToInput($event)" type="text" placeholder="æœç´¢åç§° / æ¡ç ..." class="w-full pl-10 p-2.5 bg-slate-50 rounded-lg text-sm border-none focus:bg-white focus:ring-2 focus:ring-blue-500/20 font-bold transition-all placeholder:text-slate-400">
                        </div>
                        <button v-if="isMobile" @click="toggleScanner('manage')" :class="scanning ? 'bg-blue-100 text-blue-600' : 'bg-slate-100 text-slate-600'" class="p-2.5 rounded-lg flex items-center gap-2 font-bold btn-press transition-colors">
                            <i class="ph-qr-code text-xl"></i>
                            <span class="hidden md:inline">{{ scanning ? 'å…³é—­' : 'æ‰«ç ' }}</span>
                        </button>
                    </div>

                    <div class="flex gap-2 items-center overflow-x-auto pb-1 hide-scrollbar">
                        <select v-model="productFilterStatus" class="flex-1 md:flex-none min-w-[110px] p-3 bg-white border border-slate-200 rounded-xl text-sm font-bold text-slate-700 focus:border-blue-500 focus:ring-2 focus:ring-blue-100 shadow-sm outline-none">
                            <option value="all">ğŸŸ¢ âšª å…¨éƒ¨</option>
                            <option value="active">ğŸŸ¢ æ­£å¸¸</option>
                            <option value="disabled">âšª æš‚åœ</option>
                        </select>
                        <select v-model="productFilterCategory" class="flex-1 md:flex-none min-w-[110px] p-3 bg-white border border-slate-200 rounded-xl text-sm font-bold text-slate-700 focus:border-blue-500 focus:ring-2 focus:ring-blue-100 shadow-sm outline-none">
                            <option value="all">ğŸ“ å…¨éƒ¨åˆ†ç±»</option>
                            <option v-for="cat in allCategories" :key="cat" :value="cat">{{ cat }}</option>
                        </select>
                        <button @click="exportExcel" class="w-11 h-11 shrink-0 flex items-center justify-center bg-green-50 text-green-600 rounded-xl border border-green-100 shadow-sm btn-press"><i class="ph-file-xls text-xl"></i></button>
                        <label class="w-11 h-11 shrink-0 flex items-center justify-center bg-blue-50 text-blue-600 rounded-xl border border-blue-100 shadow-sm cursor-pointer btn-press"><i class="ph-upload-simple text-xl"></i><input type="file" @change="importExcel" class="hidden" accept=".xlsx,.xls"></label>
                    </div>
                </div>

                <div v-if="isMobile && scanning && currentTab === 'manage'" class="scan-base h-[200px] shadow-inner shrink-0 ring-4 ring-black/5 rounded-2xl animate-fade-in-up">
                    <div id="manage-reader" class="w-full h-full"></div>
                </div>

                <div class="flex-1 overflow-y-auto min-h-0 custom-scroll pb-20 md:pb-0">
                    <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-3">
                        <div v-for="p in filteredProducts" :key="p.id" @click="editProduct(p)" class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 active:scale-98 transition-transform cursor-pointer relative overflow-hidden hover:border-blue-400 hover:shadow-md group">
                            <div v-if="p.status==='disabled'" class="absolute right-0 top-0 bg-red-100 text-red-600 text-[10px] px-2 py-1 rounded-bl-lg font-bold">å·²æš‚åœ</div>
                            <div v-else class="absolute right-0 top-0 bg-blue-50 text-blue-600 text-[10px] px-2 py-1 rounded-bl-lg font-bold">{{ p.category || 'é»˜è®¤' }}</div>
                            
                            <h3 :class="p.status==='disabled' ? 'text-slate-400' : 'text-slate-800'" class="font-bold truncate mb-1 text-base">{{ p.name }}</h3>
                            <p class="text-xs text-slate-400 font-mono mb-3 group-hover:text-blue-500 transition-colors">{{ p.barcode }}</p>
                            
                            <div class="flex justify-between items-end border-t border-slate-50 pt-2 text-sm">
                                <div class="text-slate-500 text-xs">æ‰¹å‘ <span class="font-bold text-slate-700 text-sm">{{ p.wholesale_price }}</span></div>
                                <div class="text-blue-600 text-xs">é›¶å”® <span class="font-bold text-base">{{ p.retail_price }}</span></div>
                            </div>
                        </div>
                        
                        <div v-if="filteredProducts.length === 0" class="col-span-full py-10 text-center text-slate-400">
                            <i class="ph-magnifying-glass text-4xl mb-2 opacity-20"></i>
                            <p class="text-xs">æœªæ‰¾åˆ°åŒ¹é…å•†å“</p>
                        </div>
                    </div>
                </div>
            </div>
            <div v-if="currentTab === 'entry'" class="flex flex-col h-full max-w-7xl mx-auto gap-4">
                
                <div v-if="isMobile" class="shrink-0 animate-fade-in-up">
                    <div v-if="scanning" class="scan-base shadow-lg h-[240px] relative rounded-2xl overflow-hidden ring-4 ring-black/5 mb-4 transition-all">
                        <div id="reader" class="w-full h-full"></div>
                        <button @click="stopScanner" class="absolute bottom-4 left-1/2 -translate-x-1/2 bg-black/60 backdrop-blur text-white px-6 py-2 rounded-full text-xs font-bold border border-white/20">å…³é—­æ‘„åƒå¤´</button>
                    </div>
                    <button v-else @click="toggleScanner('entry')" class="w-full py-6 bg-slate-900 text-white rounded-2xl font-bold shadow-xl shadow-slate-300 flex flex-col items-center justify-center gap-2 btn-press mb-6 transition-all">
                        <i class="ph-camera text-3xl"></i>
                        <span>å¼€å¯æ‘„åƒå¤´æ‰«ç </span>
                    </button>
                </div>

                <div class="flex-1 grid grid-cols-1 lg:grid-cols-2 gap-4 lg:gap-6 min-h-0 items-start">
                    
                    <div class="bg-white p-5 lg:p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col h-full lg:overflow-y-auto custom-scroll">
                        <h2 class="text-lg font-bold mb-5 flex items-center gap-2 text-slate-800 shrink-0 border-b border-slate-50 pb-3">
                            <div class="bg-blue-100 p-1.5 rounded-lg text-blue-600"><i class="ph-plus-circle text-xl"></i></div>
                            æ–°å¢å•†å“
                        </h2>
                        
                        <div class="space-y-4 flex-1">
                            <div>
                                <label class="text-xs font-bold text-slate-400 uppercase tracking-wider block mb-1.5">æ¡ç  / Barcode</label>
                                <div class="relative">
                                    <input ref="barcodeInput" v-model="entryForm.barcode" @keyup.enter="handleBarcodeEnter" type="text" class="w-full pl-10 p-3 bg-slate-50 rounded-xl font-mono text-lg font-bold border border-transparent focus:bg-white focus:border-blue-500 focus:ring-4 focus:ring-blue-500/10 transition-all placeholder:text-slate-300" placeholder="æ‰«ç æˆ–æ‰‹åŠ¨è¾“å…¥">
                                    <i class="ph-barcode absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-xl"></i>
                                </div>
                            </div>
                            
                            <div>
                                <label class="text-xs font-bold text-slate-400 uppercase tracking-wider block mb-1.5">åç§°</label>
                                <input v-model="entryForm.name" type="text" class="w-full p-3 bg-slate-50 rounded-xl border border-transparent focus:bg-white focus:border-blue-500 transition-all font-bold text-slate-700" placeholder="å•†å“åç§°">
                            </div>
                            
                            <div>
                                <label class="text-xs font-bold text-slate-400 uppercase tracking-wider block mb-1.5">åˆ†ç±»</label>
                                <div class="relative">
                                    <input list="category-list" v-model="entryForm.category" type="text" class="w-full pl-10 p-3 bg-slate-50 rounded-xl border border-transparent focus:bg-white focus:border-blue-500 font-bold transition-all" placeholder="é€‰æ‹©åˆ†ç±»">
                                    <i class="ph-tag absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-lg"></i>
                                    <datalist id="category-list"><option v-for="cat in allCategories" :value="cat"></option></datalist>
                                </div>
                            </div>
                            
                            <div class="space-y-4 pt-2 border-t border-slate-50">
                                <div>
                                    <label class="text-xs font-bold text-slate-400 uppercase tracking-wider block mb-1.5">æ‰¹å‘ä»· (Cost)</label>
                                    <div class="relative">
                                        <span class="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 font-bold text-sm">R$</span>
                                        <input v-model="entryForm.wholesale_price" type="number" class="w-full pl-10 p-3 bg-slate-50 rounded-xl font-bold text-lg border border-transparent focus:bg-white focus:border-blue-500 transition-all" placeholder="0.00">
                                    </div>
                                </div>
                                <div>
                                    <label class="text-xs font-bold text-blue-500 uppercase tracking-wider block mb-1.5">é›¶å”®ä»· (Sell)</label>
                                    <div class="relative">
                                        <span class="absolute left-3 top-1/2 -translate-y-1/2 text-blue-500 font-bold text-sm">R$</span>
                                        <input v-model="entryForm.retail_price" type="number" class="w-full pl-10 p-3 bg-blue-50/50 rounded-xl font-bold text-xl text-blue-600 border border-transparent focus:bg-white focus:border-blue-500 transition-all" placeholder="0.00">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <button @click="saveProduct" class="w-full py-4 bg-slate-900 hover:bg-slate-800 text-white rounded-xl font-bold text-lg shadow-lg shadow-slate-200 mt-6 btn-press flex items-center justify-center gap-2 transition-all shrink-0">
                            <i class="ph-check-circle text-xl"></i> ç¡®è®¤æ·»åŠ 
                        </button>
                    </div>

                    <div class="bg-white p-5 lg:p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col h-full lg:overflow-hidden">
                        <h3 class="text-lg font-bold mb-4 flex items-center gap-2 text-slate-800 shrink-0 border-b border-slate-50 pb-3">
                            <div class="bg-orange-100 p-1.5 rounded-lg text-orange-600"><i class="ph-clock-counter-clockwise text-xl"></i></div>
                            åˆšåˆšå½•å…¥
                        </h3>
                        
                        <div class="flex-1 lg:overflow-y-auto pr-1 space-y-2 custom-scroll">
                            <div v-for="p in recentProducts" :key="p.id" class="p-3 border border-slate-100 rounded-xl flex justify-between items-center bg-slate-50/50 hover:bg-blue-50 transition-all group">
                                <div class="overflow-hidden">
                                    <div class="font-bold text-slate-800 text-sm truncate">{{ p.name }}</div>
                                    <div class="text-[10px] text-slate-400 font-mono mt-0.5 group-hover:text-blue-500">{{ p.barcode }}</div>
                                </div>
                                <div class="text-right shrink-0 ml-2">
                                    <div class="text-sm text-blue-600 font-bold">R$ {{ p.retail_price }}</div>
                                    <div class="text-[10px] text-slate-400">æ‰¹: {{ p.wholesale_price }}</div>
                                </div>
                            </div>
                            
                            <div v-if="recentProducts.length === 0" class="h-full flex flex-col items-center justify-center text-slate-300 gap-2 py-10">
                                <i class="ph-clipboard-text text-3xl opacity-20"></i>
                                <span class="text-xs">æš‚æ— è®°å½•</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div v-if="currentTab === 'orders'" class="space-y-4 max-w-4xl mx-auto pb-6">
                <div class="bg-gradient-to-br from-blue-600 to-blue-800 p-6 rounded-2xl shadow-lg text-white relative overflow-hidden">
                    <i class="ph-currency-circle-dollar absolute -right-6 -top-6 text-9xl text-white/10"></i>
                    <div class="relative z-10">
                        <div class="text-blue-100 text-xs font-bold uppercase tracking-wider mb-1">ä»Šæ—¥é”€å”®æ€»é¢</div>
                        <div class="text-4xl font-black tracking-tight">R$ {{ todaySales.toFixed(2) }}</div>
                    </div>
                </div>
                
                <div class="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden">
                    <div class="p-3 border-b border-slate-100 font-bold text-sm text-slate-700 bg-slate-50 flex items-center justify-between">
                        <span>ğŸ† é”€é‡æ¦œ</span>
                        <div class="flex bg-slate-200 p-1 rounded-lg gap-1">
                            <button @click="rankingRange='today'" :class="rankingRange==='today'?'bg-white text-blue-600 shadow-sm':'text-slate-500'" class="px-2 py-1 text-[10px] rounded font-bold transition-all">ä»Šæ—¥</button>
                            <button @click="rankingRange='week'" :class="rankingRange==='week'?'bg-white text-blue-600 shadow-sm':'text-slate-500'" class="px-2 py-1 text-[10px] rounded font-bold transition-all">æœ¬å‘¨</button>
                            <button @click="rankingRange='month'" :class="rankingRange==='month'?'bg-white text-blue-600 shadow-sm':'text-slate-500'" class="px-2 py-1 text-[10px] rounded font-bold transition-all">æœ¬æœˆ</button>
                        </div>
                    </div>
                    <div class="max-h-[250px] overflow-y-auto custom-scroll">
                        <table class="w-full text-left">
                            <thead class="text-[10px] text-slate-400 bg-slate-50 sticky top-0"><tr><th class="p-3 font-bold w-10 text-center">#</th><th class="p-3 font-bold">å•†å“</th><th class="p-3 font-bold text-right">é‡</th></tr></thead>
                            <tbody class="divide-y divide-slate-50">
                                <tr v-for="(stat, idx) in productSalesStats" :key="stat.barcode"><td class="p-3 text-xs text-slate-400 font-mono text-center">{{ idx + 1 }}</td><td class="p-3 text-sm text-slate-700 font-bold"><div class="truncate max-w-[160px]">{{ stat.name }}</div></td><td class="p-3 text-sm text-slate-900 font-bold text-right">{{ stat.qty }}</td></tr>
                                <tr v-if="productSalesStats.length === 0"><td colspan="3" class="p-6 text-center text-xs text-slate-400">æš‚æ— æ•°æ®</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden">
                    <div class="p-2 border-b border-slate-100 bg-slate-50 flex gap-2">
                        <button @click="orderFilterType = 'completed'" :class="orderFilterType === 'completed' ? 'bg-white text-blue-600 shadow ring-1 ring-slate-100' : 'text-slate-400'" class="flex-1 py-2 rounded-lg text-xs font-bold transition-all">âœ… æ­£å¸¸è®¢å•</button>
                        <button @click="orderFilterType = 'void'" :class="orderFilterType === 'void' ? 'bg-white text-red-500 shadow ring-1 ring-slate-100' : 'text-slate-400'" class="flex-1 py-2 rounded-lg text-xs font-bold transition-all">ğŸš« ä½œåºŸè®¢å•</button>
                    </div>
                    <div class="divide-y divide-slate-50 min-h-[150px]">
                        <div v-for="order in filteredOrdersList" :key="order.id" @click="viewOrderDetails(order)" class="p-4 active:bg-blue-50 cursor-pointer transition-colors flex justify-between items-center">
                            <div>
                                <div class="text-[10px] text-slate-400 mb-1 font-mono">{{ formatDate(order.created_at) }}</div>
                                <div class="font-bold text-slate-800 text-base">R$ {{ order.total_price }}</div>
                                <div class="text-[10px] text-slate-500 mt-0.5">{{ order.total_quantity }} ä»¶</div>
                            </div>
                            <div class="text-right">
                                <button v-if="order.status==='completed'" @click.stop="voidOrder(order)" class="text-[10px] text-red-500 border border-red-200 px-2 py-1 rounded font-bold">ä½œåºŸ</button>
                                <button v-if="order.status==='void'" @click.stop="deleteOrder(order)" class="text-slate-400 p-2"><i class="ph-trash text-lg"></i></button>
                            </div>
                        </div>
                        <div v-if="filteredOrdersList.length === 0" class="p-8 text-center text-slate-400 text-xs">æš‚æ— è®¢å•</div>
                    </div>
                </div>
            </div>
        </div>

        <nav class="md:hidden fixed bottom-0 left-0 right-0 h-[80px] nav-blur flex justify-around items-center z-40 text-slate-400">
            <div @click="switchTab('cashier')" :class="{'active': currentTab==='cashier'}" class="nav-item flex flex-col items-center w-1/4 btn-press pt-2"><i class="ph-barcode text-2xl mb-1"></i><span class="text-[10px] font-bold">æ”¶é“¶</span></div>
            <div @click="switchTab('entry')" :class="{'active': currentTab==='entry'}" class="nav-item flex flex-col items-center w-1/4 btn-press pt-2"><i class="ph-plus-circle text-2xl mb-1"></i><span class="text-[10px] font-bold">å½•å…¥</span></div>
            <div @click="switchTab('manage')" :class="{'active': currentTab==='manage'}" class="nav-item flex flex-col items-center w-1/4 btn-press pt-2"><i class="ph-package text-2xl mb-1"></i><span class="text-[10px] font-bold">ç®¡ç†</span></div>
            <div @click="switchTab('orders')" :class="{'active': currentTab==='orders'}" class="nav-item flex flex-col items-center w-1/4 btn-press pt-2"><i class="ph-chart-bar text-2xl mb-1"></i><span class="text-[10px] font-bold">æŠ¥è¡¨</span></div>
        </nav>
    </main>

    <div v-if="showEntryModal" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
        <div class="bg-white w-full max-w-sm rounded-3xl p-6 shadow-2xl animate-fade-in-up">
            <h3 class="font-bold text-lg mb-4 text-slate-800 flex items-center gap-2 border-b border-slate-50 pb-3">
                <i class="ph-check-circle text-green-500 text-xl"></i> æ‰«ç æˆåŠŸ
            </h3>
            <div class="bg-slate-50 p-3 rounded-xl mb-4 text-center border border-slate-100">
                <div class="text-[10px] text-slate-400 font-bold uppercase tracking-wider">æ¡ç  / Barcode</div>
                <div class="font-mono text-xl font-black text-slate-800 tracking-wider mt-1">{{ entryForm.barcode }}</div>
            </div>
            <div class="space-y-3">
                <div><label class="text-[10px] font-bold text-slate-400 uppercase">åç§°</label><input v-model="entryForm.name" class="w-full p-3 border border-slate-200 rounded-xl font-bold mt-1 bg-white focus:ring-2 focus:ring-blue-100 outline-none" placeholder="è¾“å…¥å•†å“åç§°"></div>
                <div><label class="text-[10px] font-bold text-slate-400 uppercase">åˆ†ç±»</label><input v-model="entryForm.category" class="w-full p-3 border border-slate-200 rounded-xl font-bold mt-1 bg-white focus:ring-2 focus:ring-blue-100 outline-none" placeholder="è¾“å…¥åˆ†ç±»"></div>
                <div class="flex gap-3">
                    <div class="flex-1"><label class="text-[10px] font-bold text-slate-400 uppercase">æ‰¹å‘ä»·</label><input v-model="entryForm.wholesale_price" type="number" class="w-full p-3 border border-slate-200 rounded-xl font-bold mt-1 bg-white focus:ring-2 focus:ring-blue-100 outline-none"></div>
                    <div class="flex-1"><label class="text-[10px] font-bold text-blue-500 uppercase">é›¶å”®ä»·</label><input v-model="entryForm.retail_price" type="number" class="w-full p-3 border border-slate-200 rounded-xl font-bold mt-1 bg-blue-50 text-blue-600 focus:ring-2 focus:ring-blue-100 outline-none"></div>
                </div>
            </div>
            <div class="grid grid-cols-2 gap-3 mt-6">
                 <button @click="showEntryModal = false; scanning = true; startScanner('entry')" class="py-3 bg-slate-100 text-slate-600 rounded-xl font-bold text-sm">æ”¾å¼ƒ/é‡æ‰«</button>
                 <button @click="saveProduct(); showEntryModal = false; scanning = true; startScanner('entry')" class="py-3 bg-slate-900 text-white rounded-xl font-bold text-sm shadow-lg">ç¡®è®¤å¹¶ç»§ç»­</button>
            </div>
        </div>
    </div>

    <div v-if="editingProduct" class="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4">
        <div class="bg-white w-full max-w-sm rounded-3xl p-6 shadow-2xl animate-fade-in-up">
            <h3 class="font-bold text-lg mb-4 text-slate-800">ç¼–è¾‘å•†å“</h3>
            <div class="space-y-3">
                <div><label class="text-[10px] font-bold text-slate-400 uppercase">æ¡ç </label><input v-model="editingProduct.barcode" class="w-full p-2.5 border border-slate-200 rounded-lg bg-yellow-50 font-mono text-slate-700 font-bold mt-1 text-sm"></div>
                <div><label class="text-[10px] font-bold text-slate-400 uppercase">åç§°</label><input v-model="editingProduct.name" class="w-full p-2.5 border border-slate-200 rounded-lg font-bold mt-1 text-sm"></div>
                <div class="flex gap-3">
                    <div class="flex-1"><label class="text-[10px] font-bold text-slate-400 uppercase">æ‰¹å‘</label><input v-model="editingProduct.wholesale_price" type="number" class="w-full p-2.5 border border-slate-200 rounded-lg font-bold mt-1 text-sm"></div>
                    <div class="flex-1"><label class="text-[10px] font-bold text-slate-400 uppercase">é›¶å”®</label><input v-model="editingProduct.retail_price" type="number" class="w-full p-2.5 border border-slate-200 rounded-lg font-bold mt-1 text-sm text-blue-600"></div>
                </div>
                <div>
                    <label class="text-[10px] font-bold text-slate-400 uppercase">çŠ¶æ€</label>
                    <select v-model="editingProduct.status" class="w-full p-2.5 border border-slate-200 rounded-lg bg-white font-bold mt-1 text-sm">
                        <option value="active">ğŸŸ¢ æ­£å¸¸</option>
                        <option value="disabled">âšª æš‚åœ</option>
                    </select>
                </div>
            </div>
            <div class="grid grid-cols-2 gap-3 mt-6">
                <button @click="deleteProduct" class="py-3 bg-red-50 text-red-600 rounded-xl font-bold text-xs">åˆ é™¤</button>
                <button @click="updateProduct" class="py-3 bg-blue-600 text-white rounded-xl font-bold shadow-lg text-xs">ä¿å­˜</button>
            </div>
            <button @click="editingProduct = null" class="w-full mt-3 py-2 text-slate-400 text-xs font-bold">å–æ¶ˆ</button>
        </div>
    </div>

    <div v-if="viewingOrder" class="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4">
        <div class="bg-white w-full max-w-sm rounded-3xl p-5 shadow-2xl animate-fade-in-up flex flex-col max-h-[80vh]">
            <div class="flex justify-between items-center mb-3 border-b border-slate-100 pb-3">
                <div><h3 class="font-bold text-lg text-slate-800">è®¢å•è¯¦æƒ…</h3><div class="text-[10px] text-slate-400 font-mono mt-0.5">{{ formatDate(viewingOrder.created_at) }}</div></div>
                <button @click="viewingOrder = null" class="bg-slate-100 p-1.5 rounded-full text-slate-500"><i class="ph-x text-lg"></i></button>
            </div>
            <div class="flex-1 overflow-y-auto space-y-2 mb-3 pr-1 custom-scroll">
                <div v-for="item in viewingOrderItems" :key="item.id" class="flex justify-between items-center p-2.5 border border-slate-50 rounded-lg bg-slate-50/50">
                    <div class="flex-1"><div class="font-bold text-slate-700 text-sm">{{ item.product_name }}</div><div class="text-[10px] text-slate-400 font-mono mt-0.5">x{{ item.quantity }} @ {{ item.unit_price }}</div></div>
                    <div class="font-bold text-slate-800 text-sm">R$ {{ (item.quantity * item.unit_price).toFixed(2) }}</div>
                </div>
            </div>
            <div class="bg-slate-900 p-3 rounded-xl text-white">
                <div class="flex justify-between text-xs mb-1 text-slate-400"><span>æ•°é‡</span><span>{{ viewingOrder.total_quantity }}</span></div>
                <div class="flex justify-between text-lg border-t border-white/10 pt-2 mt-1"><span class="font-bold">æ€»è®¡</span><span class="font-black text-blue-300">R$ {{ viewingOrder.total_price }}</span></div>
            </div>
        </div>
    </div>

    <div v-if="showQuickAdd" class="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-start pt-[20%] justify-center p-4">
        <div class="bg-white w-full max-w-sm rounded-3xl p-6 shadow-2xl animate-fade-in-up">
            <div class="text-center mb-6">
                <h3 class="font-bold text-xl text-slate-800">å•†å“æœªå½•å…¥</h3>
                <p class="text-xs text-slate-400 font-mono mt-1 bg-slate-100 inline-block px-2 rounded">{{ quickAddForm.barcode }}</p>
            </div>
            <div class="mb-6">
                <label class="text-[10px] font-bold text-slate-400 uppercase block mb-2 text-center">è¾“å…¥{{ priceMode==='retail'?'é›¶å”®':'æ‰¹å‘' }}å•ä»·</label>
                <div class="relative">
                    <span class="absolute left-6 top-1/2 -translate-y-1/2 text-slate-400 font-bold text-xl">R$</span>
                    <input ref="quickPriceInput" v-model="quickAddForm.price" @focus="scrollToInput($event)" type="number" class="w-full p-4 pl-14 bg-slate-50 rounded-xl font-black text-3xl text-slate-800 text-center focus:bg-white focus:ring-2 focus:ring-blue-500 transition-all outline-none" placeholder="0.00">
                </div>
            </div>
            <div class="grid grid-cols-2 gap-3">
                <button @click="showQuickAdd = false" class="py-3 bg-slate-100 text-slate-600 rounded-xl font-bold text-sm">å–æ¶ˆ</button>
                <button @click="saveQuickAdd" class="py-3 bg-slate-900 text-white rounded-xl font-bold text-sm shadow-lg">ç¡®è®¤</button>
            </div>
        </div>
    </div>

</div>
<script>
    const { createClient } = supabase;
    
    // ==========================================
    // âš ï¸ è¯·åœ¨æ­¤å¤„å¡«å…¥æ‚¨çš„ Supabase é…ç½® âš ï¸
    // ==========================================
    const SUPABASE_URL = 'https://ovhjhqfjygwzvfpaiejb.supabase.co'; 
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im92aGpocWZqeWd3enZmcGFpZWpiIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2NzYzNTk4NywiZXhwIjoyMDgzMjExOTg3fQ.GYw1xicPS93oQIqOJNaqzYlq7zTcst_jo5B7JEQYZCE';
    // ==========================================

    const app = Vue.createApp({
        data() {
            return {
                supabase: null, 
                isOnline: navigator.onLine, 
                // è‡ªåŠ¨æ£€æµ‹æ˜¯å¦ä¸ºç§»åŠ¨è®¾å¤‡
                isMobile: /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),
                
                currentTab: 'cashier', // å½“å‰é¡µé¢
                
                // æ ¸å¿ƒæ•°æ®
                products: [], 
                orders: [], 
                orderItems: [], 
                
                // è¡¨å•æ•°æ®
                entryForm: { barcode: '', name: '', category: '', wholesale_price: '', retail_price: '' },
                quickAddForm: { barcode: '', price: '' }, 
                editingProduct: null, // å½“å‰æ­£åœ¨ç¼–è¾‘çš„å•†å“
                
                // æ‰«ç ç›¸å…³çŠ¶æ€
                scanning: false, 
                html5QrCode: null, 
                scanError: '', 
                lastScanTime: 0, 
                scanCooldown: 2500, // æ‰«ç å†·å´æ—¶é—´(æ¯«ç§’)ï¼Œé˜²æ­¢è¿ç»­è¯¯è¯»
                
                // UI çŠ¶æ€æ§åˆ¶
                searchText: '', 
                cashierSearch: '', 
                
                // ç­›é€‰å™¨çŠ¶æ€
                productFilterStatus: 'active', 
                productFilterCategory: 'all', 
                orderFilterType: 'completed', 
                
                // å¼¹çª—æ§åˆ¶
                showQuickAdd: false, 
                showEntryModal: false, // ç§»åŠ¨ç«¯å½•å…¥å¼¹çª—å¼€å…³
                viewingOrder: null, // è®¢å•è¯¦æƒ…å¼¹çª—æ•°æ®
                
                // æ”¶é“¶å°è®¾ç½®
                priceMode: 'retail', // 'retail' (é›¶å”®) æˆ– 'wholesale' (æ‰¹å‘)
                cart: [], 
                
                // æŠ¥è¡¨è®¾ç½®
                rankingRange: 'today', 
                
                // åˆšåˆšå½•å…¥çš„å†å²è®°å½• (æœ¬åœ°ä¸´æ—¶)
                recentProducts: [],
                
                // ç¦»çº¿åŒæ­¥é˜Ÿåˆ—
                syncQueue: JSON.parse(localStorage.getItem('syncQueue') || '[]')
            }
        },
        computed: {
            // åŠ¨æ€æ ‡é¢˜
            currentTitle() { 
                return { entry: 'å•†å“å½•å…¥', manage: 'å•†å“ç®¡ç†', cashier: 'å‰å°æ”¶é“¶', orders: 'é”€å”®æŠ¥è¡¨' }[this.currentTab]; 
            },
            
            // è·å–æ‰€æœ‰åˆ†ç±»ç”¨äºä¸‹æ‹‰æç¤º
            allCategories() { 
                const cats = new Set(this.products.map(p => p.category || 'é»˜è®¤')); 
                return Array.from(cats).sort(); 
            },
            
            // å•†å“ç®¡ç†é¡µé¢çš„ç­›é€‰é€»è¾‘
            filteredProducts() {
                let list = this.products;
                // çŠ¶æ€ç­›é€‰
                if (this.productFilterStatus !== 'all') {
                    list = list.filter(p => p.status === this.productFilterStatus);
                }
                // åˆ†ç±»ç­›é€‰
                if (this.productFilterCategory !== 'all') {
                    list = list.filter(p => (p.category || 'é»˜è®¤') === this.productFilterCategory);
                }
                // æœç´¢ç­›é€‰ (åç§°æˆ–æ¡ç )
                if (this.searchText) { 
                    const low = this.searchText.toLowerCase(); 
                    list = list.filter(p => p.name?.toLowerCase().includes(low) || p.barcode.includes(low)); 
                }
                return list;
            },
            
            // è®¢å•åˆ—è¡¨ç­›é€‰
            filteredOrdersList() { 
                return this.orders
                    .filter(o => o.status === this.orderFilterType)
                    .sort((a, b) => new Date(b.created_at) - new Date(a.created_at)); 
            },
            
            // è´­ç‰©è½¦æ€»é‡‘é¢
            cartTotalPrice() { 
                return this.cart.reduce((sum, item) => sum + (item.unit_price * item.quantity), 0).toFixed(2); 
            },
            
            // è´­ç‰©è½¦æ€»æ•°é‡
            cartTotalQty() { 
                return this.cart.reduce((sum, item) => sum + item.quantity, 0); 
            },
            
            // å½“å‰æŸ¥çœ‹è®¢å•çš„å•†å“è¯¦æƒ…
            viewingOrderItems() { 
                if (!this.viewingOrder) return []; 
                return this.orderItems.filter(i => i.order_id === this.viewingOrder.id); 
            },
            
            // ä»Šæ—¥é”€å”®é¢ç»Ÿè®¡ (åŸºäºåœ£ä¿ç½—æ—¶é—´)
            todaySales() { 
                const spDate = this.getSaoPauloDateString(new Date()); 
                return this.orders
                    .filter(o => o.status === 'completed' && this.formatDate(o.created_at).includes(spDate))
                    .reduce((sum, o) => sum + o.total_price, 0); 
            },
            
            // é”€é‡æ’è¡Œç»Ÿè®¡é€»è¾‘
            productSalesStats() {
                const now = new Date(); 
                let startTime;
                
                // ç¡®å®šç»Ÿè®¡æ—¶é—´èŒƒå›´
                if (this.rankingRange === 'today') {
                    const spDate = this.getSaoPauloDateString(now);
                    const validOrderIds = new Set(this.orders.filter(o => o.status === 'completed' && this.formatDate(o.created_at).includes(spDate)).map(o => o.id));
                    return this.calcStats(validOrderIds);
                } else {
                    const spNow = new Date(now.toLocaleString('en-US', { timeZone: 'America/Sao_Paulo' }));
                    if (this.rankingRange === 'week') { 
                        const day = spNow.getDay() || 7; 
                        spNow.setHours(0,0,0,0); 
                        spNow.setDate(spNow.getDate() - day + 1); 
                        startTime = spNow; 
                    } else if (this.rankingRange === 'month') { 
                        spNow.setDate(1); 
                        spNow.setHours(0,0,0,0); 
                        startTime = spNow; 
                    }
                    const validOrderIds = new Set(this.orders.filter(o => o.status === 'completed' && new Date(o.created_at) >= startTime).map(o => o.id));
                    return this.calcStats(validOrderIds);
                }
            }
        },
async mounted() {
            // åˆå§‹åŒ– Supabase å®¢æˆ·ç«¯
            this.supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
            
            // åŠ è½½æœ¬åœ°ç¼“å­˜æ•°æ® (å®ç°ç¦»çº¿ç§’å¼€)
            this.loadLocalData(); 
            
            // å°è¯•ä»äº‘ç«¯æ‹‰å–æœ€æ–°æ•°æ®
            await this.fetchData();
            
            // ç›‘å¬ç½‘ç»œçŠ¶æ€
            window.addEventListener('online', () => { 
                this.isOnline = true; 
                this.processSyncQueue(); // ä¸Šçº¿åè‡ªåŠ¨åŒæ­¥ç¦»çº¿æ“ä½œ
            });
            window.addEventListener('offline', () => { 
                this.isOnline = false; 
            });
            
            // å®šæ—¶å°è¯•åŒæ­¥ (æ¯10ç§’)
            setInterval(this.processSyncQueue, 10000);
            
            // PCç«¯è‡ªåŠ¨èšç„¦æ”¶é“¶è¾“å…¥æ¡† (ç§»åŠ¨ç«¯ç¦ç”¨ï¼Œé˜²æ­¢é”®ç›˜è‡ªåŠ¨å¼¹å‡º)
            this.$nextTick(() => { 
                if(this.$refs.cashierInput && !this.isMobile) this.$refs.cashierInput.focus(); 
            });
        },
        methods: {
            // -----------------------------------------------------------
            // ğŸ”” æ ¸å¿ƒäº¤äº’ï¼šæ‰«ç éŸ³æ•ˆ
            // -----------------------------------------------------------
            playBeep() { 
                // ä½¿ç”¨æ›´æ¸…æ™°å“äº®çš„â€œæ»´â€å£° Base64
                const a = new Audio("data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAAB3d3d3d3d3d4eHh4eHh4eHl5eXl5eXl5eYmJiYmJiYmJiXl5eXl5eXl5eHh4eHh4eHh4d3d3d3d3d3d3d3d3d3d3d3d4eHh4eHh4eHl5eXl5eXl5eYmJiYmJiYmJiXl5eXl5eXl5eHh4eHh4eHh4d3d3d3d3d3dw=="); 
                a.volume = 1.0;
                a.currentTime = 0; // å…³é”®ï¼šæ¯æ¬¡æ’­æ”¾å‰é‡ç½®è¿›åº¦ï¼Œé˜²æ­¢è¿ç»­æ‰«ææ—¶æ²¡å£°éŸ³
                a.play().catch(e => console.log("å£°éŸ³æ’­æ”¾è¢«æ‹¦æˆª:", e)); 
                
                // å…¼å®¹æ€§éœ‡åŠ¨ (ä»…å®‰å“ç”Ÿæ•ˆ)
                if (navigator.vibrate) navigator.vibrate(200);
            },
            
            onScanSuccess(decodedText, tab) {
                const now = Date.now(); 
                if (now - this.lastScanTime < this.scanCooldown) return; 
                this.lastScanTime = now; 
                
                // 1. ç«‹å³æ’­æ”¾å£°éŸ³
                this.playBeep();
                
                // 2. é€»è¾‘å¤„ç†
                if (tab === 'entry') { 
                    this.entryForm.barcode = decodedText; 
                    
                    if (this.isMobile) {
                        this.stopScanner(); // åœæ­¢æ‰«æ
                        this.showEntryModal = true; // å¼¹å‡ºå½•å…¥çª—
                    } else {
                        this.handleBarcodeEnter(); 
                    }
                } 
                else if (tab === 'cashier') { 
                    this.cashierSearch = decodedText; 
                    this.addToCartByInput(); 
                }
                else if (tab === 'manage') { 
                    this.searchText = decodedText; 
                }
            },
            // -----------------------------------------------------------
            // ğŸ“¸ æ ¸å¿ƒåŠŸèƒ½ï¼šæ‘„åƒå¤´æ‰«ç é€»è¾‘
            // -----------------------------------------------------------
            async toggleScanner(tab) { 
                if (this.scanning) { 
                    await this.stopScanner(); 
                } else { 
                    this.currentTab = tab; 
                    this.scanning = true; 
                    await this.$nextTick(); 
                    this.startScanner(tab); 
                } 
            },
            async startScanner(tab) {
                this.scanError = ''; 
                const elementId = tab === 'entry' ? "reader" : (tab === 'manage' ? 'manage-reader' : "cashier-reader");
                
                if (!this.html5QrCode) { 
                    this.html5QrCode = new Html5Qrcode(elementId); 
                }
                
                try { 
                    this.scanning = true; 
                    
                    // ğŸš€ æ ¸å¿ƒä¿®æ”¹ï¼šä¼˜åŒ–æ‰«æé…ç½®
                    const config = { 
                        fps: 15, // æé«˜å¸§ç‡
                        qrbox: { width: 280, height: 150 }, // æ”¹ä¸ºé•¿æ–¹å½¢æ‰«ææ¡†ï¼Œæ›´å¥‘åˆæ¡å½¢ç 
                        aspectRatio: 1.0,
                        experimentalFeatures: {
                            useBarCodeDetectorIfSupported: true // ğŸš€ å…³é”®ï¼šå¯ç”¨æ‰‹æœºåŸç”Ÿæ‰«ç èƒ½åŠ›ï¼Œå¤§å¹…æå‡å‡†ç¡®åº¦
                        }
                    };

                    await this.html5QrCode.start(
                        { facingMode: "environment" }, 
                        config, 
                        (decodedText) => this.onScanSuccess(decodedText, tab), 
                        (errorMessage) => { /* å¿½ç•¥æŠ¥é”™ */ }
                    ); 
                } catch (err) { 
                    console.error(err);
                    this.scanning = false; 
                    this.scanError = "æ‘„åƒå¤´å¯åŠ¨å¤±è´¥ï¼Œè¯·æ£€æŸ¥æƒé™"; 
                    this.html5QrCode = null; 
                }
            },
            
            async stopScanner() { 
                if (this.html5QrCode && this.html5QrCode.isScanning) { 
                    try { 
                        await this.html5QrCode.stop(); 
                        this.html5QrCode.clear(); 
                    } catch (e) { console.error(e); } 
                } 
                this.html5QrCode = null; 
                this.scanning = false; 
            },
            
            // âœ… æ‰«ç æˆåŠŸå›è°ƒ
            onScanSuccess(decodedText, tab) {
                const now = Date.now(); 
                // é˜²æ­¢çŸ­æ—¶é—´å†…é‡å¤è¯†åˆ«
                if (now - this.lastScanTime < this.scanCooldown) return; 
                this.lastScanTime = now; 
                
                // 1. æ’­æ”¾æç¤ºéŸ³
                this.playBeep();
                
                // 2. æ ¹æ®ä¸šåŠ¡åœºæ™¯å¤„ç†
                if (tab === 'entry') { 
                    this.entryForm.barcode = decodedText; 
                    
                    if (this.isMobile) {
                        // ã€ç§»åŠ¨ç«¯é€»è¾‘ã€‘æ‰«ç æˆåŠŸå -> æš‚åœæ‰«æ -> å¼¹å‡ºå½•å…¥å°çª—
                        this.stopScanner();
                        this.showEntryModal = true;
                    } else {
                        // ã€PCç«¯é€»è¾‘ã€‘ç›´æ¥å°è¯•æŸ¥è¯¢æˆ–èšç„¦
                        this.handleBarcodeEnter(); 
                    }
                } 
                else if (tab === 'cashier') { 
                    this.cashierSearch = decodedText; 
                    this.addToCartByInput(); // ç›´æ¥åŠ å…¥è´­ç‰©è½¦
                }
                else if (tab === 'manage') { 
                    this.searchText = decodedText; 
                }
            },

            // -----------------------------------------------------------
            // ğŸ› ï¸ è¾…åŠ©åŠŸèƒ½
            // -----------------------------------------------------------
            scrollToInput(event) { 
                // è½¯é”®ç›˜å¼¹å‡ºæ—¶ï¼Œå°†è¾“å…¥æ¡†æ»šåŠ¨åˆ°å¯è§†åŒºåŸŸä¸­å¿ƒ
                const el = event.target; 
                setTimeout(() => { 
                    el.scrollIntoView({ behavior: 'smooth', block: 'center' }); 
                }, 300); 
            },
            
            async switchTab(tab) { 
                // åˆ‡æ¢ Tab æ—¶è‡ªåŠ¨å…³é—­æ‘„åƒå¤´
                if (this.scanning) await this.stopScanner(); 
                this.currentTab = tab; 
                
                // å¤„ç†è‡ªåŠ¨èšç„¦ (ä»…é™éç§»åŠ¨ç«¯)
                this.$nextTick(() => {
                    if (!this.isMobile) {
                        if (tab === 'cashier' && this.$refs.cashierInput) this.$refs.cashierInput.focus();
                        if (tab === 'entry' && this.$refs.barcodeInput) this.$refs.barcodeInput.focus();
                        if (tab === 'manage' && this.$refs.manageInput) this.$refs.manageInput.focus();
                    }
                });
            },

            // -----------------------------------------------------------
            // ğŸ’¾ æ•°æ®å±‚é€»è¾‘
            // -----------------------------------------------------------
            loadLocalData() { 
                this.products = JSON.parse(localStorage.getItem('products') || '[]'); 
                this.orders = JSON.parse(localStorage.getItem('orders') || '[]'); 
                this.orderItems = JSON.parse(localStorage.getItem('orderItems') || '[]'); 
            },
            
            async fetchData() {
                if (!this.isOnline) return;
                
                // å¹¶å‘åŠ è½½æ•°æ®æå‡é€Ÿåº¦
                const [pRes, oRes, oiRes] = await Promise.all([
                    this.supabase.from('products').select('*'),
                    this.supabase.from('orders').select('*').order('created_at', { ascending: false }).limit(100),
                    this.supabase.from('order_items').select('*').limit(1000)
                ]);

                if (pRes.data) { 
                    this.products = pRes.data; 
                    localStorage.setItem('products', JSON.stringify(pRes.data)); 
                }
                if (oRes.data) { 
                    this.orders = oRes.data; 
                    localStorage.setItem('orders', JSON.stringify(oRes.data)); 
                }
                if (oiRes.data) { 
                    this.orderItems = oiRes.data; 
                    localStorage.setItem('orderItems', JSON.stringify(oiRes.data)); 
                }
            },
            
            // ç¦»çº¿åŒæ­¥é˜Ÿåˆ—å¤„ç†
            addToSyncQueue(table, action, data) { 
                this.syncQueue.push({ table, action, data, retry: 0 }); 
                localStorage.setItem('syncQueue', JSON.stringify(this.syncQueue)); 
                this.processSyncQueue(); 
            },
            
            async processSyncQueue() {
                if (!this.isOnline || !this.syncQueue.length) return; 
                
                const item = this.syncQueue[0];
                try { 
                    if (item.action === 'insert') {
                        await this.supabase.from(item.table).insert(item.data); 
                    } else if (item.action === 'update') { 
                        const { id, ...updates } = item.data; 
                        await this.supabase.from(item.table).update(updates).eq('id', id); 
                    } else if (item.action === 'delete') {
                        // é€»è¾‘åˆ é™¤é€šå¸¸æ˜¯ update statusï¼Œç‰©ç†åˆ é™¤å¦‚ä¸‹ï¼š
                         await this.supabase.from(item.table).delete().eq('id', item.data.id);
                    }
                    
                    // æˆåŠŸåç§»é™¤é˜Ÿåˆ—é¦–é¡¹
                    this.syncQueue.shift(); 
                    localStorage.setItem('syncQueue', JSON.stringify(this.syncQueue)); 
                    this.processSyncQueue(); // é€’å½’å¤„ç†ä¸‹ä¸€æ¡
                } catch (e) { 
                    console.error('Sync failed:', e);
                    item.retry++; 
                    if(item.retry > 3) {
                        // é‡è¯•è¶…è¿‡3æ¬¡è·³è¿‡è¯¥ä»»åŠ¡ï¼Œé¿å…é˜»å¡
                        this.syncQueue.shift(); 
                        localStorage.setItem('syncQueue', JSON.stringify(this.syncQueue)); 
                    }
                }
            },

            // è¾…åŠ©è®¡ç®—å‡½æ•°
            calcStats(ids) { 
                const stats = {}; 
                this.orderItems.forEach(item => { 
                    if (ids.has(item.order_id)) { 
                        if (!stats[item.barcode]) stats[item.barcode] = { name: item.product_name, barcode: item.barcode, qty: 0 }; 
                        stats[item.barcode].qty += item.quantity; 
                    } 
                }); 
                return Object.values(stats).sort((a, b) => b.qty - a.qty); 
            },
            
            getSaoPauloDateString(date) { 
                return date.toLocaleDateString('zh-CN', { timeZone: 'America/Sao_Paulo' }).split('/').join('-'); 
            },
            
            formatDate(str) { 
                if(!str) return ''; 
                return new Date(str).toLocaleString('zh-CN', { 
                    timeZone: 'America/Sao_Paulo', 
                    month:'numeric', day:'numeric', hour:'numeric', minute:'numeric', hour12: false 
                }); 
            },
            // -----------------------------------------------------------
            // ğŸ›’ æ”¶é“¶å°ä¸šåŠ¡é€»è¾‘
            // -----------------------------------------------------------
            switchPriceMode(mode) {
                this.priceMode = mode;
                // åˆ‡æ¢æ¨¡å¼æ—¶è‡ªåŠ¨æ›´æ–°è´­ç‰©è½¦å†…çš„å•ä»·
                this.cart.forEach(item => {
                    const product = this.products.find(p => p.id === item.product_id);
                    if (product) { 
                        item.unit_price = mode === 'retail' ? product.retail_price : product.wholesale_price; 
                    }
                });
            },
            
            addToCartByInput() {
                const term = this.cashierSearch.trim(); 
                if (!term) return;
                
                // ä¼˜å…ˆåŒ¹é…æ¡ç ï¼Œå…¶æ¬¡åŒ¹é…åç§°
                let p = this.products.find(x => x.barcode === term && x.status === 'active');
                if (!p) p = this.products.find(x => x.name === term && x.status === 'active');
                
                if (p) {
                    // å•†å“å­˜åœ¨ -> åŠ å…¥è´­ç‰©è½¦
                    const existing = this.cart.find(i => i.product_id === p.id);
                    if (existing) {
                        existing.quantity++; 
                    } else {
                        this.cart.push({ 
                            product_id: p.id, 
                            name: p.name, 
                            barcode: p.barcode, 
                            unit_price: this.priceMode === 'retail' ? p.retail_price : p.wholesale_price, 
                            quantity: 1 
                        });
                    }
                    this.cashierSearch = ''; // æ¸…ç©ºè¾“å…¥æ¡†
                } else {
                    // å•†å“ä¸å­˜åœ¨ -> å¼¹å‡ºå¿«é€Ÿå…¥åº“çª—å£
                    this.quickAddForm = { barcode: term, price: '' };
                    this.showQuickAdd = true;
                    this.$nextTick(() => { if(this.$refs.quickPriceInput) this.$refs.quickPriceInput.focus(); });
                }
            },
            
            removeFromCart(idx) { this.cart.splice(idx, 1); },
            
            clearCart() { 
                if(confirm('ç¡®å®šæ¸…ç©ºå½“å‰è´­ç‰©è½¦å—?')) this.cart = []; 
            },
            
            // âœ… ç»“ç®—é€»è¾‘
            checkoutDirectly() {
                const total = this.cartTotalPrice; 
                // ç§»åŠ¨ç«¯ç®€å•ç¡®è®¤ï¼Œé˜²æ­¢è¯¯è§¦
                if (!confirm(`æ€»é‡‘é¢ï¼šR$ ${total}\n\nç¡®è®¤æ”¶æ¬¾ï¼Ÿ`)) return;
                
                const orderId = crypto.randomUUID(); 
                const now = new Date().toISOString();
                
                // 1. åˆ›å»ºè®¢å•å¯¹è±¡
                const order = { 
                    id: orderId, 
                    total_price: parseFloat(total), 
                    total_quantity: this.cartTotalQty, 
                    price_type: this.priceMode, 
                    payment_method: 'å¸¸è§„ç»“ç®—', 
                    status: 'completed', 
                    created_at: now 
                };
                
                // 2. åˆ›å»ºè®¢å•è¯¦æƒ…é¡¹
                const items = this.cart.map(i => ({ 
                    order_id: orderId, 
                    product_id: i.product_id, 
                    product_name: i.name, 
                    barcode: i.barcode, 
                    unit_price: i.unit_price, 
                    quantity: i.quantity, 
                    subtotal: i.unit_price * i.quantity 
                }));
                
                // 3. ä¿å­˜åˆ°æœ¬åœ°ä¸åŒæ­¥é˜Ÿåˆ—
                this.orders.unshift(order); 
                this.orderItems.push(...items); 
                
                localStorage.setItem('orders', JSON.stringify(this.orders)); 
                localStorage.setItem('orderItems', JSON.stringify(this.orderItems));
                
                this.addToSyncQueue('orders', 'insert', order); 
                this.addToSyncQueue('order_items', 'insert', items);
                
                // 4. é‡ç½®çŠ¶æ€å¹¶è·³è½¬
                this.cart = []; 
                this.switchTab('orders');
            },

            // -----------------------------------------------------------
            // ğŸ“ å•†å“å½•å…¥ä¸šåŠ¡é€»è¾‘
            // -----------------------------------------------------------
            getNextName() {
                // è‡ªåŠ¨ç”Ÿæˆ "æœªå‘½å1", "æœªå‘½å2"
                let max = 0; const regex = /^æœªå‘½å(\d+)$/;
                this.products.forEach(p => { 
                    const match = p.name.match(regex); 
                    if (match) { const num = parseInt(match[1]); if (num > max) max = num; } 
                });
                return `æœªå‘½å${max + 1}`;
            },

            handleBarcodeEnter() { 
                if (!this.entryForm.barcode) return; 
                const exists = this.products.find(p => p.barcode === this.entryForm.barcode); 
                if (exists) alert('æç¤ºï¼šè¯¥æ¡ç å·²å­˜åœ¨ (' + exists.name + ')'); 
            },
            
            // âœ… ä¿å­˜å•†å“ (æ ¸å¿ƒ)
            saveProduct() {
                if (!this.entryForm.barcode) return alert('å¿…é¡»è¾“å…¥æ¡å½¢ç ');
                
                let finalName = this.entryForm.name || this.getNextName();
                
                const p = { 
                    barcode: this.entryForm.barcode, 
                    name: finalName, 
                    category: this.entryForm.category || 'é»˜è®¤', 
                    wholesale_price: parseFloat(this.entryForm.wholesale_price) || 0, 
                    retail_price: parseFloat(this.entryForm.retail_price) || 0, 
                    status: 'active' 
                };
                
                const tempId = crypto.randomUUID(); 
                
                // ä¿å­˜
                this.products.unshift({ ...p, id: tempId }); 
                localStorage.setItem('products', JSON.stringify(this.products)); 
                this.addToSyncQueue('products', 'insert', p);
                
                // æ›´æ–°"åˆšåˆšå½•å…¥"åˆ—è¡¨
                this.recentProducts.unshift(p); 
                if (this.recentProducts.length > 20) this.recentProducts.pop();

                // ğŸŒŸ å…³é”®ï¼šä¿å­˜åæ¸…ç©ºè¡¨å•ï¼Œä»¥ä¾¿è¿ç»­å½•å…¥
                this.entryForm = { barcode: '', name: '', category: '', wholesale_price: '', retail_price: '' }; 
                
                // PCç«¯è‡ªåŠ¨èšç„¦å›æ¡ç æ¡†
                if (!this.isMobile && this.$refs.barcodeInput) {
                    this.$refs.barcodeInput.focus();
                }
            },
            
            // æ”¶é“¶å°å¿«é€Ÿæ–°å¢é€»è¾‘
            saveQuickAdd() {
                if (!this.quickAddForm.price) return alert('è¯·è¾“å…¥ä»·æ ¼');
                
                const finalName = this.getNextName();
                const priceVal = parseFloat(this.quickAddForm.price);
                const retail = this.priceMode === 'retail' ? priceVal : 0;
                const wholesale = this.priceMode === 'wholesale' ? priceVal : 0;

                const p = { 
                    barcode: this.quickAddForm.barcode, 
                    name: finalName, 
                    category: 'é»˜è®¤', 
                    wholesale_price: wholesale, 
                    retail_price: retail, 
                    status: 'active' 
                };
                const tempId = crypto.randomUUID(); 
                
                this.products.unshift({ ...p, id: tempId }); 
                localStorage.setItem('products', JSON.stringify(this.products)); 
                this.addToSyncQueue('products', 'insert', p);
                
                this.recentProducts.unshift(p);
                
                // ç›´æ¥åŠ å…¥è´­ç‰©è½¦
                this.cart.push({ 
                    product_id: tempId, 
                    name: p.name, 
                    barcode: p.barcode, 
                    unit_price: priceVal, 
                    quantity: 1 
                });
                
                this.showQuickAdd = false; 
                this.cashierSearch = '';
            },

            // -----------------------------------------------------------
            // âš™ï¸ è®¢å•ä¸å•†å“ç®¡ç†é€»è¾‘
            // -----------------------------------------------------------
            voidOrder(order) { 
                if(!confirm('ç¡®è®¤ä½œåºŸæ­¤è®¢å•?')) return; 
                order.status = 'void'; 
                localStorage.setItem('orders', JSON.stringify(this.orders)); 
                this.addToSyncQueue('orders', 'update', { id: order.id, status: 'void' }); 
            },
            
            async deleteOrder(order) {
                if(!confirm('ç¡®å®šè¦æ°¸ä¹…åˆ é™¤? æ­¤æ“ä½œä¸å¯æ¢å¤ã€‚')) return;
                this.orders = this.orders.filter(o => o.id !== order.id); 
                localStorage.setItem('orders', JSON.stringify(this.orders));
                
                if (this.isOnline) { 
                    const { error } = await this.supabase.from('orders').delete().eq('id', order.id); 
                    if (error) alert('åˆ é™¤å¤±è´¥'); 
                } else { 
                    this.addToSyncQueue('orders', 'delete', { id: order.id });
                }
            },
            
            viewOrderDetails(order) { this.viewingOrder = order; },
            
            editProduct(p) { this.editingProduct = JSON.parse(JSON.stringify(p)); },
            
            async updateProduct() {
                const idx = this.products.findIndex(p => p.id === this.editingProduct.id); 
                if (idx !== -1) this.products[idx] = this.editingProduct;
                
                localStorage.setItem('products', JSON.stringify(this.products));
                
                const { id, ...updates } = this.editingProduct; 
                this.addToSyncQueue('products', 'update', { id, ...updates }); 
                this.editingProduct = null;
            },
            
            async deleteProduct() {
                if(!confirm('âš ï¸ è­¦å‘Šï¼šç¡®å®šè¦åˆ é™¤æ­¤å•†å“å—ï¼Ÿ')) return;
                const idToDelete = this.editingProduct.id;
                
                if (this.isOnline) {
                    const { error } = await this.supabase.from('products').delete().eq('id', idToDelete);
                    if (error) {
                        // å¦‚æœå› å¤–é”®çº¦æŸåˆ é™¤å¤±è´¥(æœ‰å…³è”è®¢å•)ï¼Œåˆ™è½¯åˆ é™¤
                        await this.supabase.from('products').update({ status: 'disabled' }).eq('id', idToDelete);
                        const idx = this.products.findIndex(p => p.id === idToDelete); 
                        if (idx !== -1) this.products[idx].status = 'disabled';
                        localStorage.setItem('products', JSON.stringify(this.products));
                        alert('æç¤ºï¼šè¯¥å•†å“å­˜åœ¨å†å²è®¢å•ï¼Œå·²è‡ªåŠ¨è½¬ä¸ºã€æš‚åœé”€å”®ã€‘çŠ¶æ€ã€‚');
                    } else {
                        // ç‰©ç†åˆ é™¤æˆåŠŸ
                        this.products = this.products.filter(p => p.id !== idToDelete); 
                        localStorage.setItem('products', JSON.stringify(this.products));
                    }
                } else { 
                    // ç¦»çº¿æ¨¡å¼æš‚ä¸æ”¯æŒå¤æ‚åˆ é™¤æ ¡éªŒ
                    alert('ç¦»çº¿æ¨¡å¼å»ºè®®ä»…ä¿®æ”¹çŠ¶æ€ä¸ºæš‚åœ'); 
                }
                this.editingProduct = null;
            },
            
            // -----------------------------------------------------------
            // ğŸ“‚ Excel å¯¼å…¥å¯¼å‡º
            // -----------------------------------------------------------
            exportExcel() { 
                const ws = XLSX.utils.json_to_sheet(this.products); 
                const wb = XLSX.utils.book_new(); 
                XLSX.utils.book_append_sheet(wb, ws, "Products"); 
                XLSX.writeFile(wb, "Products_Backup.xlsx"); 
            },
            
            importExcel(e) { 
                const f = e.target.files[0]; 
                const r = new FileReader(); 
                r.onload = (evt) => { 
                    const wb = XLSX.read(evt.target.result, { type: 'binary' }); 
                    const data = XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]]); 
                    
                    if(confirm(`å‡†å¤‡å¯¼å…¥ ${data.length} æ¡å•†å“æ•°æ®?`)) { 
                        data.forEach(row => { 
                            const p = { 
                                barcode: row['barcode']||row['æ¡ç '], 
                                name: row['name']||row['åç§°'], 
                                category: row['category']||'é»˜è®¤', 
                                wholesale_price: row['wholesale']||0, 
                                retail_price: row['retail']||0, 
                                status: 'active' 
                            }; 
                            if(p.barcode) this.addToSyncQueue('products', 'insert', p); 
                        }); 
                        alert('å·²åŠ å…¥åŒæ­¥é˜Ÿåˆ—ï¼Œè¯·ä¿æŒç½‘ç»œè¿æ¥'); 
                        window.location.reload(); // ç®€å•åˆ·æ–°ä»¥åŠ è½½æ–°æ•°æ®
                    } 
                }; 
                r.readAsBinaryString(f); 
            }
        }
    });
    app.mount('#app');
</script>
</body>
</html>


